{"ast":null,"code":"import React,{useContext,useEffect,useState}from\"react\";import LayOut from\"../../components/LayOut/LayOut.JSx\";import{db}from\"../../Utility/fireBase\";import{DataContext}from\"../../components/DataProvider/DataProvider\";import classes from\"./Orders.module.css\";import{collection,doc,query,orderBy,onSnapshot}from'firebase/firestore';import ProductCard from\"../../components/Product/ProductCard\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function Orders(){const[{user},dispatch]=useContext(DataContext);const[orders,setOrders]=useState([]);useEffect(()=>{if(user){const ordersRef=collection(db,'users',user.uid,'orders');const q=query(ordersRef,orderBy('created','desc'));const unsubscribe=onSnapshot(q,snapshot=>{console.log(snapshot);setOrders(snapshot.docs.map(doc=>({id:doc.id,data:doc.data()})));});// Cleanup the subscription when the component unmounts\nreturn()=>unsubscribe();}else{setOrders([]);}},[user]);return/*#__PURE__*/_jsx(LayOut,{children:/*#__PURE__*/_jsx(\"section\",{className:classes.container,children:/*#__PURE__*/_jsxs(\"div\",{className:classes.orders_container,children:[/*#__PURE__*/_jsx(\"h2\",{children:\" Your Orders\"}),(orders===null||orders===void 0?void 0:orders.length)==0&&/*#__PURE__*/_jsx(\"div\",{style:{padding:\"20px\"},children:\"You don't have orders yet.\"}),/*#__PURE__*/_jsx(\"div\",{children:orders===null||orders===void 0?void 0:orders.map((eachOrder,i)=>{var _eachOrder$data,_eachOrder$data$baske;return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Order Id:\",eachOrder===null||eachOrder===void 0?void 0:eachOrder.id]}),eachOrder===null||eachOrder===void 0?void 0:(_eachOrder$data=eachOrder.data)===null||_eachOrder$data===void 0?void 0:(_eachOrder$data$baske=_eachOrder$data.basket)===null||_eachOrder$data$baske===void 0?void 0:_eachOrder$data$baske.map(order=>{return/*#__PURE__*/_jsx(ProductCard,{flex:true,product:order},order.id);})]},i);})})]})})});}export default Orders;","map":{"version":3,"names":["React","useContext","useEffect","useState","LayOut","db","DataContext","classes","collection","doc","query","orderBy","onSnapshot","ProductCard","jsx","_jsx","jsxs","_jsxs","Orders","user","dispatch","orders","setOrders","ordersRef","uid","q","unsubscribe","snapshot","console","log","docs","map","id","data","children","className","container","orders_container","length","style","padding","eachOrder","i","_eachOrder$data","_eachOrder$data$baske","basket","order","flex","product"],"sources":["C:/Users/selam/Desktop/evangadi class/phase 4 projects/Amazonclone_proj/amazonclone_proj/frontend/src/Pages/Orders/Orders.jsx"],"sourcesContent":["import React, { useContext, useEffect, useState } from \"react\";\r\nimport LayOut from \"../../components/LayOut/LayOut.JSx\";\r\nimport { db } from \"../../Utility/fireBase\";\r\nimport { DataContext } from \"../../components/DataProvider/DataProvider\";\r\nimport classes from \"./Orders.module.css\";\r\nimport { collection, doc, query, orderBy, onSnapshot } from 'firebase/firestore';\r\nimport ProductCard from \"../../components/Product/ProductCard\";\r\nfunction Orders() {\r\n  const [{ user }, dispatch] = useContext(DataContext);\r\n  const [orders, setOrders] = useState([]);\r\n  useEffect(() => {\r\n    if (user) {\r\n      const ordersRef = collection(db, 'users', user.uid, 'orders');\r\n      const q = query(ordersRef, orderBy('created', 'desc'));\r\n\r\n      const unsubscribe = onSnapshot(q, (snapshot) => {\r\n        console.log(snapshot);\r\n        setOrders(\r\n          snapshot.docs.map((doc) => ({\r\n            id: doc.id,\r\n            data: doc.data(),\r\n          }))\r\n        );\r\n      });\r\n\r\n      // Cleanup the subscription when the component unmounts\r\n      return () => unsubscribe();\r\n    } else {\r\n      setOrders([]);\r\n    }\r\n  }, [user]);\r\n  return (\r\n    <LayOut>\r\n      <section className={classes.container}>\r\n        <div className={classes.orders_container}>\r\n          <h2> Your Orders</h2>\r\n          {\r\n            orders?.length == 0 &&<div style={{padding:\"20px\"}}>You don't have orders yet.</div>\r\n          }\r\n          {/* Order Items */}\r\n          <div>\r\n            {orders?.map((eachOrder, i) => {\r\n              return (\r\n                <div key={i}>\r\n                  <hr />\r\n                  <p>Order Id:{eachOrder?.id}</p>\r\n                  {eachOrder?.data?.basket?.map((order) => {\r\n                    return (\r\n                      <ProductCard flex={true} product={order} key={order.id} />\r\n                    );\r\n                  })}\r\n                </div>\r\n              );\r\n            })}\r\n          </div>\r\n        </div>\r\n      </section>\r\n    </LayOut>\r\n  );\r\n}\r\n\r\nexport default Orders;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}